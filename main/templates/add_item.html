{% extends 'base.html' %}

{% block content %}

<div class="row justify-content-center">
    <div class="col-md-7 col-lg-6">
        <div class="card shadow-sm">
            <div class="card-body">
                <h3 class="card-title mb-3 text-center">Add Lost/Found Item</h3>

                <form method="post" enctype="multipart/form-data" novalidate>
                    {% csrf_token %}
                    {% for field in form %}
                        <div class="mb-3">
                            <label for="{{ field.id_for_label }}" class="form-label">
                                {{ field.label }}
                                {% if field.field.required %}<span class="text-danger">*</span>{% endif %}
                            </label>
                            
                            {% if field.name == 'image' %}
                                <div class="mb-2">
                                    <input type="file" 
                                           name="{{ field.name }}" 
                                           id="{{ field.id_for_label }}" 
                                           class="form-control" 
                                           accept="image/*"
                                           onchange="previewImage(this)">
                                    {% if field.help_text %}
                                        <div class="form-text">{{ field.help_text }}</div>
                                    {% endif %}
                                </div>
                                <div id="imagePreview" class="mb-2" style="display: none;">
                                    <img id="previewImg" src="#" alt="Preview" class="img-thumbnail" style="max-height: 300px; max-width: 100%;">
                                </div>
                            {% else %}
                                {{ field }}
                            {% endif %}

                            {% for error in field.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ error }}
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}

                    <button class="btn btn-primary w-100 mt-2">Create</button>
                </form>

                <script>
                    function previewImage(input) {
                        const preview = document.getElementById('imagePreview');
                        const previewImg = document.getElementById('previewImg');
                        
                        if (input.files && input.files[0]) {
                            const reader = new FileReader();
                            
                            reader.onload = function(e) {
                                previewImg.src = e.target.result;
                                preview.style.display = 'block';
                            }
                            
                            reader.readAsDataURL(input.files[0]);
                        } else {
                            preview.style.display = 'none';
                        }
                    }
                </script>
            </div>
        </div>
    </div>
</div>

{% endblock %}
